package data;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Iterator;
import java.util.function.Function;

public class ResultSetIterator<T> implements Iterator<T> {
	private final ResultSet rs;
	private final FunctionThatThrows<ResultSet, T> action;
	
	public ResultSetIterator(ResultSet rs, FunctionThatThrows<ResultSet, T> action) {
		this.rs = rs;
		this.action = action;
	}

	@Override
	public boolean hasNext() {
		try {
			return rs.next();
		} catch (SQLException e) {
			throw new RuntimeException(e);
		}
	}

	@Override
	public T next() {
		try {
			return action.apply(rs);
		} catch (SQLException e) {
			throw new RuntimeException(e);
		}
	}

}
