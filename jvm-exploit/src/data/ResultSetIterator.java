package data;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Iterator;

public class ResultSetIterator<E> implements Iterator<E> {
	private final ResultSet rs;
	private final ResultSetReader<E> action;
	
	public ResultSetIterator(ResultSet rs, ResultSetReader<E> action) {
		this.rs = rs;
		this.action = action;
	}

	@Override
	public boolean hasNext() {
		try {
			return rs.next();
		} catch (SQLException e) {
			throw new RuntimeException(e);
		}
	}

	@Override
	public E next() {
		try {
			return action.read(rs);
		} catch (SQLException e) {
			throw new RuntimeException(e);
		}
	}

}
