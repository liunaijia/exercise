package bytecode;

import java.io.IOException;

public class ClassFile {
	private String magic;
	private Version version;
	private ConstantPool constantPool;
	private AccessFlags accessFlags;
	private ClassName thisClass;
	private ClassName superClass;
	private Interfaces interfaces;

	public ClassFile(String classFilePath) throws IOException {
		try (ByteCodeReader reader = new ByteCodeReader(classFilePath)) {
			this.magic = reader.read4uHexString();
			this.version = new Version(reader);
			this.constantPool = new ConstantPool(reader);
			this.accessFlags = new AccessFlags(reader);

			this.thisClass = new ClassName(reader, this.constantPool);
			this.superClass = new ClassName(reader, this.constantPool);
			this.interfaces = new Interfaces(reader, this.constantPool);
		}
	}

	@Override
	public String toString() {
		StringBuilder sb = new StringBuilder();
		sb.append(String.format("Magic: %s%n", magic))
				.append(String.format("Version: %s%n", version))
				.append(String.format("Constant pool: %n%s", constantPool))
				.append(String.format("Access Flags: %s%n", accessFlags))
				.append(String.format("This Class: %s%n", thisClass))
				.append(String.format("Super Class: %s%n", superClass))
				.append(String.format("Interfaces: %s%n", interfaces));
		return sb.toString();
	}

}
