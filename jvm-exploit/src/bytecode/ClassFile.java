package bytecode;

import java.io.IOException;

public class ClassFile {
	private String magic;
	private Version version;
	private ConstantPool constantPool;
	private AccessFlags accessFlags;
	private ClassName thisClass;
	private ClassName superClass;
	private Interfaces interfaces;
	private Fields fields;

	public ClassFile(String classFilePath) throws IOException {
		try (ByteCodeReader reader = new ByteCodeReader(classFilePath)) {
			this.magic = reader.read4uHexString();
			this.version = new Version(reader);
			this.constantPool = new ConstantPool(reader);
			this.accessFlags = new AccessFlags(reader);

			this.thisClass = new ClassName(reader, this.constantPool);
			this.superClass = new ClassName(reader, this.constantPool);
			this.interfaces = new Interfaces(reader, this.constantPool);
			this.fields = new Fields(reader, this.constantPool);
		}
	}

	@Override
	public String toString() {
		StringBuilder sb = new StringBuilder();
		sb.append(String.format("Magic: %s%n", this.magic))
				.append(String.format("Version: %s%n", this.version))
				.append(String.format("Constant pool: %n%s", this.constantPool))
				.append(String.format("Access Flags: %s%n", this.accessFlags))
				.append(String.format("This Class: %s%n", this.thisClass))
				.append(String.format("Super Class: %s%n", this.superClass))
				.append(String.format("Interfaces: %s%n", this.interfaces))
				.append(String.format("Fields: %n%s", this.fields));
		return sb.toString();
	}

}
