package bytecode;

import java.io.DataInputStream;
import java.io.IOException;
import java.nio.charset.Charset;

public class ConstantUtf8Info extends ConstantPoolInfo {
	private final String string;
	
	public ConstantUtf8Info(DataInputStream stream, boolean checkTag) throws IOException {
		super(stream, checkTag);
		int length = new U2(stream).getValue();
		
		byte[] bytes = new byte[length];
		for(int i = 0; i < length; i++){
			bytes[i] = (byte)new U1(stream).getValue();
		}
		
		this.string = new String(bytes, 0, bytes.length, Charset.forName("utf-8"));
	}
	
	public String getString() {
		return this.string;
	}
	
	@Override
	public String toString() {
		return String.format("Utf8 %s", string);
	}

	@Override
	protected int getTag() {
		return 1;
	}
}
